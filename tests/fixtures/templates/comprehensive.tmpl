# Comprehensive Template Test
# Tests all custom and built-in Tera functions

## 1. Built-in get_env() function
### With defaults:
PORT={{ get_env(name="TEST_PORT", default="8080") }}
HOST={{ get_env(name="TEST_HOST", default="localhost") }}
DEBUG={{ get_env(name="TEST_DEBUG", default="false") }}

### Without defaults (set by test):
API_KEY={{ get_env(name="TEST_API_KEY") }}

## 2. Custom filter_env() function
### Filter by pattern:
{% for var in filter_env(pattern="TEST_SERVER_*") -%}
{{ var.key }}={{ var.value }}
{% endfor %}

## 3. Built-in filters
### String filters:
{% set name = get_env(name="TEST_NAME", default="john doe") -%}
Original: {{ name }}
Upper: {{ name | upper }}
Lower: {{ name | lower }}
Title: {{ name | title }}
Slugified: {{ name | slugify }}
Trimmed: {{ "  spaces  " | trim }}

### Array filters:
{% set items = get_env(name="TEST_ITEMS", default="apple,banana,cherry") | split(",") | list -%}
Items count: {{ items | length }}
Items:
{%- for item in items %}
  - {{ item | title }}
{%- endfor %}

### Number formatting:
File size: {{ 1048576 | filesizeformat }}

### URL encoding:
Encoded: {{ "hello world & foo=bar" | urlencode }}

## 4. Conditionals with environment variables
{% set enable_feature = get_env(name="TEST_FEATURE_FLAG", default="false") -%}
{% if enable_feature == "true" -%}
Feature is ENABLED
{% else -%}
Feature is DISABLED
{% endif %}

## 5. Loops with filter_env
Database connections:
{% set db_vars = filter_env(pattern="TEST_DB_*") -%}
{% if db_vars | length > 0 -%}
{%- for var in db_vars %}
  {{ var.key }}: {{ var.value }}
{%- endfor %}
{% else -%}
  No database variables found
{% endif %}

## 6. Complex operations
### Combining filters and functions:
{% set tags = get_env(name="TEST_TAGS", default="rust,tera,cli") | split(",") | list -%}
Tags ({{ tags | length }} total):
{%- for tag in tags %}
  #{{ tag | upper }}
{%- endfor %}

### Nested conditionals:
{% set env_type = get_env(name="TEST_ENV", default="development") -%}
{% if env_type == "production" -%}
Environment: PRODUCTION ({{ env_type | upper }})
Log level: ERROR
{% elif env_type == "staging" -%}
Environment: STAGING ({{ env_type | upper }})
Log level: WARN
{% else -%}
Environment: DEVELOPMENT ({{ env_type | upper }})
Log level: DEBUG
{% endif %}

## 7. Comments (should not appear in output)
{# This is a comment and should not appear in the output #}
{# Neither should this:
   Multi-line comment
   with multiple lines
#}

## 8. Date/time function
Current timestamp: {{ now() }}

## 9. Random number function
Random (1-10): {{ get_random(start=1, end=10) }}

## 10. String concatenation with filters
{% set service = get_env(name="TEST_SERVICE", default="web") -%}
Service name: {{ service | upper }}_SERVICE
Container: {{ service }}-container-{{ get_random(start=100, end=999) }}

## End of comprehensive test

